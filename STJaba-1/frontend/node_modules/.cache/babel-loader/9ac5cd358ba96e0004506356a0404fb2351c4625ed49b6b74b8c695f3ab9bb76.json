{"ast":null,"code":"var _jsxFileName = \"/Users/abdullahzayed/STJaba-1/frontend2/src/components/MapDisplay.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\n\n// MapDisplay shows the map image and overlays incidents (red) and vehicles (blue).\n// Coordinates passed in incidents/vehicles are expected to be normalized [0-1].\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MapDisplay({\n  incidents = [],\n  vehicles = [],\n  selectedIncidentLocation,\n  selectedVehicleLocation,\n  onMapClick\n}) {\n  _s();\n  const imgRef = useRef(null);\n  const svgRef = useRef(null);\n  const [size, setSize] = useState({\n    w: 600,\n    h: 600\n  });\n  useEffect(() => {\n    const img = imgRef.current;\n    if (!img) return;\n    const update = () => setSize({\n      w: img.clientWidth,\n      h: img.clientHeight\n    });\n    update();\n    window.addEventListener('resize', update);\n    return () => window.removeEventListener('resize', update);\n  }, []);\n  const handleClick = e => {\n    const img = imgRef.current;\n    if (!img) return;\n    const rect = img.getBoundingClientRect();\n    const x = (e.clientX - rect.left) / rect.width;\n    const y = (e.clientY - rect.top) / rect.height;\n    // normalized coords\n    onMapClick && onMapClick({\n      x: parseFloat(x.toFixed(4)),\n      y: parseFloat(y.toFixed(4))\n    });\n  };\n  const renderMarkers = () => {\n    const elems = [];\n    const r = 8;\n    // Only show pending incidents on the map\n    incidents.filter(i => i.status === 'pending').forEach(inc => {\n      var _inc$location$x, _inc$location, _inc$location$y, _inc$location2;\n      const x = ((_inc$location$x = (_inc$location = inc.location) === null || _inc$location === void 0 ? void 0 : _inc$location.x) !== null && _inc$location$x !== void 0 ? _inc$location$x : 0) * size.w;\n      const y = ((_inc$location$y = (_inc$location2 = inc.location) === null || _inc$location2 === void 0 ? void 0 : _inc$location2.y) !== null && _inc$location$y !== void 0 ? _inc$location$y : 0) * size.h;\n      elems.push(/*#__PURE__*/_jsxDEV(\"circle\", {\n        cx: x,\n        cy: y,\n        r: r,\n        fill: \"red\",\n        stroke: \"#900\",\n        strokeWidth: 1\n      }, `inc-${inc.id}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 9\n      }, this));\n    });\n    vehicles.forEach(veh => {\n      var _veh$location$x, _veh$location, _veh$location$y, _veh$location2;\n      const x = ((_veh$location$x = (_veh$location = veh.location) === null || _veh$location === void 0 ? void 0 : _veh$location.x) !== null && _veh$location$x !== void 0 ? _veh$location$x : 0) * size.w;\n      const y = ((_veh$location$y = (_veh$location2 = veh.location) === null || _veh$location2 === void 0 ? void 0 : _veh$location2.y) !== null && _veh$location$y !== void 0 ? _veh$location$y : 0) * size.h;\n      elems.push(/*#__PURE__*/_jsxDEV(\"circle\", {\n        cx: x,\n        cy: y,\n        r: r,\n        fill: \"blue\",\n        stroke: \"#003\",\n        strokeWidth: 1\n      }, `veh-${veh.id}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this));\n    });\n\n    // Selected (to-be-created or edited) markers appear as green dots\n    if (selectedIncidentLocation) {\n      var _selectedIncidentLoca, _selectedIncidentLoca2;\n      const x = ((_selectedIncidentLoca = selectedIncidentLocation.x) !== null && _selectedIncidentLoca !== void 0 ? _selectedIncidentLoca : 0) * size.w;\n      const y = ((_selectedIncidentLoca2 = selectedIncidentLocation.y) !== null && _selectedIncidentLoca2 !== void 0 ? _selectedIncidentLoca2 : 0) * size.h;\n      elems.push(/*#__PURE__*/_jsxDEV(\"circle\", {\n        cx: x,\n        cy: y,\n        r: 6,\n        fill: \"limegreen\",\n        stroke: \"#065\",\n        strokeWidth: 1\n      }, \"selected-incident\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 18\n      }, this));\n    }\n    if (selectedVehicleLocation) {\n      var _selectedVehicleLocat, _selectedVehicleLocat2;\n      const x = ((_selectedVehicleLocat = selectedVehicleLocation.x) !== null && _selectedVehicleLocat !== void 0 ? _selectedVehicleLocat : 0) * size.w;\n      const y = ((_selectedVehicleLocat2 = selectedVehicleLocation.y) !== null && _selectedVehicleLocat2 !== void 0 ? _selectedVehicleLocat2 : 0) * size.h;\n      elems.push(/*#__PURE__*/_jsxDEV(\"circle\", {\n        cx: x,\n        cy: y,\n        r: 6,\n        fill: \"#00cc66\",\n        stroke: \"#036\",\n        strokeWidth: 1\n      }, \"selected-vehicle\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 18\n      }, this));\n    }\n    return elems;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"map-container panel\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        paddingBottom: 6\n      },\n      className: \"coords-box\",\n      children: \"Click map to pick location\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      ref: imgRef,\n      className: \"map-image\",\n      src: \"/map.png\",\n      alt: \"map\",\n      onClick: handleClick,\n      onLoad: e => setSize({\n        w: e.target.clientWidth,\n        h: e.target.clientHeight\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n      ref: svgRef,\n      className: \"overlay-svg\",\n      width: size.w,\n      height: size.h,\n      style: {\n        width: size.w,\n        height: size.h\n      },\n      children: renderMarkers()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n}\n_s(MapDisplay, \"4v/XwbtDXORSB/Cu/iMi59b40Fg=\");\n_c = MapDisplay;\nvar _c;\n$RefreshReg$(_c, \"MapDisplay\");","map":{"version":3,"names":["React","useEffect","useRef","useState","jsxDEV","_jsxDEV","MapDisplay","incidents","vehicles","selectedIncidentLocation","selectedVehicleLocation","onMapClick","_s","imgRef","svgRef","size","setSize","w","h","img","current","update","clientWidth","clientHeight","window","addEventListener","removeEventListener","handleClick","e","rect","getBoundingClientRect","x","clientX","left","width","y","clientY","top","height","parseFloat","toFixed","renderMarkers","elems","r","filter","i","status","forEach","inc","_inc$location$x","_inc$location","_inc$location$y","_inc$location2","location","push","cx","cy","fill","stroke","strokeWidth","id","fileName","_jsxFileName","lineNumber","columnNumber","veh","_veh$location$x","_veh$location","_veh$location$y","_veh$location2","_selectedIncidentLoca","_selectedIncidentLoca2","_selectedVehicleLocat","_selectedVehicleLocat2","className","children","style","textAlign","paddingBottom","ref","src","alt","onClick","onLoad","target","_c","$RefreshReg$"],"sources":["/Users/abdullahzayed/STJaba-1/frontend2/src/components/MapDisplay.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\n\n// MapDisplay shows the map image and overlays incidents (red) and vehicles (blue).\n// Coordinates passed in incidents/vehicles are expected to be normalized [0-1].\n\nexport default function MapDisplay({ incidents = [], vehicles = [], selectedIncidentLocation, selectedVehicleLocation, onMapClick }){\n  const imgRef = useRef(null)\n  const svgRef = useRef(null)\n  const [size, setSize] = useState({w: 600, h: 600})\n\n  useEffect(()=>{\n    const img = imgRef.current\n    if(!img) return\n    const update = ()=> setSize({w: img.clientWidth, h: img.clientHeight})\n    update()\n    window.addEventListener('resize', update)\n    return ()=> window.removeEventListener('resize', update)\n  },[])\n\n  const handleClick = (e) =>{\n    const img = imgRef.current\n    if(!img) return\n    const rect = img.getBoundingClientRect()\n    const x = (e.clientX - rect.left) / rect.width\n    const y = (e.clientY - rect.top) / rect.height\n    // normalized coords\n    onMapClick && onMapClick({ x: parseFloat(x.toFixed(4)), y: parseFloat(y.toFixed(4)) })\n  }\n\n  const renderMarkers = () => {\n    const elems = []\n    const r = 8\n    // Only show pending incidents on the map\n    incidents.filter(i => i.status === 'pending').forEach((inc) => {\n      const x = (inc.location?.x ?? 0) * size.w\n      const y = (inc.location?.y ?? 0) * size.h\n      elems.push(\n        <circle key={`inc-${inc.id}`} cx={x} cy={y} r={r} fill=\"red\" stroke=\"#900\" strokeWidth={1} />\n      )\n    })\n    vehicles.forEach((veh) => {\n      const x = (veh.location?.x ?? 0) * size.w\n      const y = (veh.location?.y ?? 0) * size.h\n      elems.push(\n        <circle key={`veh-${veh.id}`} cx={x} cy={y} r={r} fill=\"blue\" stroke=\"#003\" strokeWidth={1} />\n      )\n    })\n\n    // Selected (to-be-created or edited) markers appear as green dots\n    if(selectedIncidentLocation){\n      const x = (selectedIncidentLocation.x ?? 0) * size.w\n      const y = (selectedIncidentLocation.y ?? 0) * size.h\n      elems.push(<circle key=\"selected-incident\" cx={x} cy={y} r={6} fill=\"limegreen\" stroke=\"#065\" strokeWidth={1} />)\n    }\n    if(selectedVehicleLocation){\n      const x = (selectedVehicleLocation.x ?? 0) * size.w\n      const y = (selectedVehicleLocation.y ?? 0) * size.h\n      elems.push(<circle key=\"selected-vehicle\" cx={x} cy={y} r={6} fill=\"#00cc66\" stroke=\"#036\" strokeWidth={1} />)\n    }\n\n    return elems\n  }\n\n  return (\n    <div className=\"map-container panel\">\n      <div style={{textAlign:'center', paddingBottom:6}} className=\"coords-box\">Click map to pick location</div>\n      <img\n        ref={imgRef}\n        className=\"map-image\"\n        src=\"/map.png\"\n        alt=\"map\"\n        onClick={handleClick}\n        onLoad={(e)=> setSize({w: e.target.clientWidth, h: e.target.clientHeight})}\n      />\n\n      <svg\n        ref={svgRef}\n        className=\"overlay-svg\"\n        width={size.w}\n        height={size.h}\n        style={{ width: size.w, height: size.h }}\n      >\n        {renderMarkers()}\n      </svg>\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}